webpackJsonp([8],{264:function(l,n,u){"use strict";function t(l){return a._22(0,[(l()(),a.Z(0,0,null,null,4,"div",[],null,null,null,null,null)),(l()(),a._20(-1,null,["\n          "])),(l()(),a.Z(2,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),a._20(-1,null,["Phone calls are disabled"])),(l()(),a._20(-1,null,["\n        "]))],null,null)}function e(l){return a._22(0,[(l()(),a._20(-1,null,["\n"])),(l()(),a.Z(1,0,null,null,20,"ion-header",[],null,null,null,null,null)),a.Y(2,16384,null,0,P.a,[C.a,a.j,a.z,[2,V.a]],null,null),(l()(),a._20(-1,null,["\n\n  "])),(l()(),a.Z(4,0,null,null,16,"ion-navbar",[["class","toolbar"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,Y.b,Y.a)),a.Y(5,49152,null,0,w.a,[j.a,[2,V.a],[2,z.a],C.a,a.j,a.z],null,null),(l()(),a._20(-1,3,["\n    "])),(l()(),a.Z(7,0,null,0,8,"button",[["color","hamburgermenu"],["ion-button",""],["menuToggle",""]],[[8,"hidden",0]],[[null,"click"]],function(l,n,u){var t=!0;if("click"===n){t=!1!==a._11(l,9).toggle()&&t}return t},S.b,S.a)),a.Y(8,1097728,[[1,4]],0,A.a,[[8,""],C.a,a.j,a.z],{color:[0,"color"]},null),a.Y(9,1064960,null,0,B.a,[M.a,[2,V.a],[2,A.a],[2,w.a]],{menuToggle:[0,"menuToggle"]},null),a.Y(10,16384,null,1,W.a,[C.a,a.j,a.z,[2,E.a],[2,w.a]],{color:[0,"color"]},null),a._18(603979776,1,{_buttons:1}),(l()(),a._20(-1,0,["\n      "])),(l()(),a.Z(13,0,null,0,1,"ion-icon",[["name","menu"],["role","img"]],[[2,"hide",null]],null,null,null,null)),a.Y(14,147456,null,0,I.a,[C.a,a.j,a.z],{name:[0,"name"]},null),(l()(),a._20(-1,0,["\n    "])),(l()(),a._20(-1,3,["\n    "])),(l()(),a.Z(17,0,null,3,2,"ion-title",[],null,null,null,N.b,N.a)),a.Y(18,49152,null,0,T.a,[C.a,a.j,a.z,[2,E.a],[2,w.a]],null,null),(l()(),a._20(-1,0,["Phone Call"])),(l()(),a._20(-1,3,["\n  "])),(l()(),a._20(-1,null,["\n"])),(l()(),a._20(-1,null,["\n"])),(l()(),a.Z(23,0,null,null,75,"ion-content",[["padding",""]],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,x.b,x.a)),a.Y(24,4374528,null,0,U.a,[C.a,q.a,O.a,a.j,a.z,j.a,R.a,a.u,[2,V.a],[2,z.a]],null,null),(l()(),a._20(-1,1,["\n  "])),(l()(),a.Z(26,0,null,1,71,"div",[],null,null,null,null,null)),(l()(),a._20(-1,null,["\n    "])),(l()(),a.Z(28,0,null,null,25,"ion-card",[],null,null,null,null,null)),a.Y(29,16384,null,0,F.a,[C.a,a.j,a.z],null,null),(l()(),a._20(-1,null,["\n      "])),(l()(),a.Z(31,0,null,null,5,"ion-card-header",[],null,null,null,null,null)),a.Y(32,16384,null,0,D.a,[C.a,a.j,a.z],null,null),(l()(),a._20(-1,null,["\n        "])),(l()(),a.Z(34,0,null,null,1,"strong",[],null,null,null,null,null)),(l()(),a._20(-1,null,["Phone Call Rates"])),(l()(),a._20(-1,null,["\n      "])),(l()(),a._20(-1,null,["\n      "])),(l()(),a.Z(38,0,null,null,14,"ion-card-content",[],null,null,null,null,null)),a.Y(39,16384,null,0,J.a,[C.a,a.j,a.z],null,null),(l()(),a._20(-1,null,["\n        "])),(l()(),a.Z(41,0,null,null,4,"p",[["class","paragraph"]],null,null,null,null,null)),(l()(),a._20(-1,null,["Our rate per minute: "])),(l()(),a.Z(43,0,null,null,1,"strong",[],null,null,null,null,null)),(l()(),a._20(44,null,["$",""])),(l()(),a._20(-1,null,["."])),(l()(),a._20(-1,null,["\n        "])),(l()(),a.Z(47,0,null,null,4,"p",[],null,null,null,null,null)),(l()(),a._20(-1,null,[" Your communications balance: "])),(l()(),a.Z(49,0,null,null,1,"strong",[],null,null,null,null,null)),(l()(),a._20(50,null,["$",""])),(l()(),a._20(-1,null,["."])),(l()(),a._20(-1,null,["\n      "])),(l()(),a._20(-1,null,["\n    "])),(l()(),a._20(-1,null,["\n    "])),(l()(),a.Z(55,0,null,null,41,"ion-card",[],null,null,null,null,null)),a.Y(56,16384,null,0,F.a,[C.a,a.j,a.z],null,null),(l()(),a._20(-1,null,["\n      "])),(l()(),a.Z(58,0,null,null,5,"ion-card-header",[],null,null,null,null,null)),a.Y(59,16384,null,0,D.a,[C.a,a.j,a.z],null,null),(l()(),a._20(-1,null,["\n        "])),(l()(),a.Z(61,0,null,null,1,"strong",[],null,null,null,null,null)),(l()(),a._20(-1,null,["Make a phone call"])),(l()(),a._20(-1,null,["\n      "])),(l()(),a._20(-1,null,["\n      "])),(l()(),a.Z(65,0,null,null,30,"ion-card-content",[],null,null,null,null,null)),a.Y(66,16384,null,0,J.a,[C.a,a.j,a.z],null,null),(l()(),a._20(-1,null,["\n        "])),(l()(),a.Z(68,0,null,null,4,"p",[["class","paragraph"]],null,null,null,null,null)),(l()(),a._20(-1,null,["Your phone number is saved as "])),(l()(),a.Z(70,0,null,null,1,"strong",[],null,null,null,null,null)),(l()(),a._20(71,null,["",""])),(l()(),a._20(-1,null,["."])),(l()(),a._20(-1,null,["\n        "])),(l()(),a.Z(74,0,null,null,4,"p",[["class","paragraph"]],null,null,null,null,null)),(l()(),a._20(-1,null,["Click the button below to place an outbound call to inmate "])),(l()(),a.Z(76,0,null,null,1,"strong",[],null,null,null,null,null)),(l()(),a._20(77,null,["","\n            ",""])),(l()(),a._20(-1,null,["."])),(l()(),a._20(-1,null,["\n\n        "])),(l()(),a.Z(80,0,null,null,4,"p",[["class","paragraph"]],null,null,null,null,null)),(l()(),a._20(-1,null,["Write down this one-time access code in case it is requested: "])),(l()(),a.Z(82,0,null,null,1,"strong",[],null,null,null,null,null)),(l()(),a._20(83,null,["",""])),(l()(),a._20(-1,null,["."])),(l()(),a._20(-1,null,["\n        "])),(l()(),a.Z(86,0,null,null,5,"button",[["block",""],["class","paragraph"],["ion-button",""]],[[8,"disabled",0]],[[null,"click"]],function(l,n,u){var t=!0;if("click"===n){t=!1!==l.component.makeAPhoneCall()&&t}return t},S.b,S.a)),a.Y(87,1097728,null,0,A.a,[[8,""],C.a,a.j,a.z],{block:[0,"block"]},null),(l()(),a._20(-1,0,["\n          "])),(l()(),a.Z(89,0,null,0,1,"ion-icon",[["class","phoneIcon"],["name","call"],["role","img"]],[[2,"hide",null]],null,null,null,null)),a.Y(90,147456,null,0,I.a,[C.a,a.j,a.z],{name:[0,"name"]},null),(l()(),a._20(-1,0,["Make a phone call\n        "])),(l()(),a._20(-1,null,["\n        "])),(l()(),a.U(16777216,null,null,1,null,t)),a.Y(94,16384,null,0,H.k,[a.I,a.F],{ngIf:[0,"ngIf"]},null),(l()(),a._20(-1,null,["\n      "])),(l()(),a._20(-1,null,["\n    "])),(l()(),a._20(-1,null,["\n  "])),(l()(),a._20(-1,1,["\n"]))],function(l,n){var u=n.component;l(n,8,0,"hamburgermenu");l(n,9,0,"");l(n,10,0,"hamburgermenu");l(n,14,0,"menu");l(n,87,0,"");l(n,90,0,"call");l(n,94,0,u.display)},function(l,n){var u=n.component;l(n,4,0,a._11(n,5)._hidden,a._11(n,5)._sbPadding);l(n,7,0,a._11(n,9).isHidden);l(n,13,0,a._11(n,14)._hidden);l(n,23,0,a._11(n,24).statusbarPadding,a._11(n,24)._hasRefresher);l(n,44,0,u.rateByWebUser);l(n,50,0,u.accountBalance);l(n,71,0,u.phoneNumber);l(n,77,0,u.inmate.firstname,u.inmate.lastname);l(n,83,0,u.OTP);l(n,86,0,!u.callEnabled);l(n,89,0,a._11(n,90)._hidden)})}Object.defineProperty(n,"__esModule",{value:!0});var a=u(0),i=(u(3),u(57),u(41)),o=(u(59),u(145)),s=u(134),r=u(413),c=this&&this.__awaiter||function(l,n,u,t){return new(u||(u=Promise))(function(e,a){function i(l){try{s(t.next(l))}catch(l){a(l)}}function o(l){try{s(t.throw(l))}catch(l){a(l)}}function s(l){l.done?e(l.value):new u(function(n){n(l.value)}).then(i,o)}s((t=t.apply(l,n||[])).next())})},h=this&&this.__generator||function(l,n){function u(u){return function(i){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,e&&(a=e[2&u[0]?"return":u[0]?"throw":"next"])&&!(a=a.call(e,u[1])).done)return a;switch(e=0,a&&(u=[0,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,e=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(a=o.trys,!(a=a.length>0&&a[a.length-1])&&(6===u[0]||2===u[0])){o=0;continue}if(3===u[0]&&(!a||u[1]>a[0]&&u[1]<a[3])){o.label=u[1];break}if(6===u[0]&&o.label<a[1]){o.label=a[1],a=u;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(u);break}a[2]&&o.ops.pop(),o.trys.pop();continue}u=n.call(l,o)}catch(l){u=[6,l],e=0}finally{t=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,i])}}var t,e,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i},d=function(){function l(l,n,u,t,e,a,i,o){this.navCtrl=l,this.navParams=n,this.storage=u,this.alertCtrl=t,this.phones=e,this.commaccount=a,this.loadingCtrl=i,this.nativeStorage=o,this.validPhone=!1,this.callEnabled=!0,this.display=!1}return l.prototype.ionViewCanEnter=function(){return c(this,void 0,void 0,function(){var l,n,u,t,e,a,i,o,s,r,c,d;return h(this,function(h){switch(h.label){case 0:return l=this.loadingCtrl.create({content:"Loading..."}),[4,l.present()];case 1:h.sent(),h.label=2;case 2:return h.trys.push([2,12,13,15]),n=this,[4,this.storage.get("webuserid")];case 3:return n.user=h.sent(),u=this,[4,this.storage.get("inmate")];case 4:return u.inmate=h.sent(),[4,this.nativeStorage.getItem("userInfo")];case 5:return t=h.sent(),e=JSON.parse(t),a=e.u,i=e.p,o=this,[4,this.phones.Authenticate(a,i)];case 6:return o.phoneJWT=h.sent(),s=this,[4,this.storage.get("location")];case 7:return s.siteID=h.sent(),r=this,[4,this.storage.get("isattorney")];case 8:return r.isAttorney=h.sent(),c=this,[4,this.phones.getPhoneSettings(this.siteID,this.phoneJWT)];case 9:return c.siteSettings=h.sent(),[4,this.prepareNumbers()];case 10:return h.sent(),[4,this.phones.MakePhoneCall(this.phoneJWT,this.inmate.id,this.user,this.siteID,!0,this.phone,this.isAttorney)];case 11:return d=h.sent(),this.OTP=d.Code,[3,15];case 12:return h.sent(),this.alertCtrl.create({title:"Error",subTitle:"Unable to load call data at this time",buttons:["Ok"]}).present(),[3,15];case 13:return[4,l.dismiss()];case 14:return h.sent(),[7];case 15:return[2]}})})},l.prototype.prepareNumbers=function(){return c(this,void 0,void 0,function(){var l,n,u;return h(this,function(t){switch(t.label){case 0:return l=this,[4,this.storage.get("webuserphone")];case 1:return l.phone=t.sent(),[4,this.commaccount.GetUserWebBalance(this.user)];case 2:return n=t.sent(),this.accountBalance=n.getWebuserAccountBalanceResult.toFixed(2),[4,this.commaccount.getRateByWebUser(this.user,this.siteID,r.b.Voip,1===this.isAttorney?r.a.PrivilegedVoip:r.a.Voip)];case 3:return u=t.sent(),this.rateByWebUser=u.RateByWebuserResult,this.phone.toString().length>=10?(this.validPhone=!0,this.formatPhoneNumber(this.phone)):this.phone.toString().length<10&&this.throwAlert(),2*this.rateByWebUser>this.accountBalance?(this.callEnabled=!1,this.throwNotEnoughFundsAlert()):2*this.rateByWebUser<=this.accountBalance&&void 0!=this.siteSettings.site_did?this.callEnabled=!0:2*this.rateByWebUser<=this.accountBalance&&void 0==this.siteSettings.site_did&&(this.callEnabled=!1,this.display=!0),[2]}})})},l.prototype.formatPhoneNumber=function(l){var n=(""+l).replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{4})$/);return n&&(this.phoneNumber="("+n[1]+") "+n[2]+"-"+n[3]),null},l.prototype.throwAlert=function(){var l=this;this.alertCtrl.create({title:"Missing Phone Number",message:"We are missing a valid phone number for you.",buttons:[{text:"Okay",handler:function(){l.navCtrl.setRoot("HomePage")}}]}).present()},l.prototype.throwNotEnoughFundsAlert=function(){this.alertCtrl.create({title:"Not Enough Funds",subTitle:"Please deposit more funds into your communications account before placing this call.",buttons:["Ok"]}).present()},l.prototype.makeAPhoneCall=function(){return c(this,void 0,void 0,function(){var l;return h(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,4]),[4,this.finishPhoneCall()];case 1:return n.sent(),[3,4];case 2:return l=n.sent(),[4,console.log(l)];case 3:return n.sent(),this.navCtrl.setRoot("HomePage"),[3,4];case 4:return[2]}})})},l.prototype.finishPhoneCall=function(){window.location.href="tel:"+this.siteSettings.site_did},l}(),b=function(){return function(){}}(),p=u(200),_=u(201),g=u(202),m=u(203),f=u(204),v=u(205),k=u(206),y=u(207),Z=u(208),P=u(84),C=u(1),V=u(5),Y=u(275),w=u(34),j=u(8),z=u(20),S=u(46),A=u(19),B=u(128),M=u(22),W=u(129),E=u(35),I=u(38),N=u(210),T=u(58),x=u(209),U=u(21),q=u(4),O=u(9),R=u(24),F=u(132),D=u(137),J=u(135),H=u(11),$=u(10),G=u(127),X=u(86),L=u(85),K=a.X({encapsulation:2,styles:[],data:{}}),Q=a.V("page-phone-call",d,function(l){return a._22(0,[(l()(),a.Z(0,0,null,null,1,"page-phone-call",[],null,null,null,e,K)),a.Y(1,49152,null,0,d,[z.a,$.a,G.b,X.a,o.a,s.a,L.a,i.a],null,null)],null,null)},{},{},[]),ll=u(18),nl=u(126),ul=u(39);u.d(n,"PhoneCallPageModuleNgFactory",function(){return tl});var tl=a.W(b,[],function(l){return a._7([a._8(512,a.i,a.S,[[8,[p.a,_.a,g.a,m.a,f.a,v.a,k.a,y.a,Z.a,Q]],[3,a.i],a.s]),a._8(4608,H.m,H.l,[a.r,[2,H.u]]),a._8(4608,ll.s,ll.s,[]),a._8(4608,ll.d,ll.d,[]),a._8(512,H.b,H.b,[]),a._8(512,ll.q,ll.q,[]),a._8(512,ll.i,ll.i,[]),a._8(512,ll.o,ll.o,[]),a._8(512,nl.a,nl.a,[]),a._8(512,nl.b,nl.b,[]),a._8(512,b,b,[]),a._8(256,ul.a,d,[])])})},275:function(l,n,u){"use strict";function t(l){return e._22(0,[(l()(),e.Z(0,0,null,null,1,"div",[["class","toolbar-background"]],null,null,null,null,null)),e.Y(1,278528,null,0,a.i,[e.p,e.q,e.j,e.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(l()(),e.Z(2,0,null,null,8,"button",[["class","back-button"],["ion-button","bar-button"]],[[8,"hidden",0]],[[null,"click"]],function(l,n,u){var t=!0;if("click"===n){t=!1!==l.component.backButtonClick(u)&&t}return t},i.b,i.a)),e.Y(3,278528,null,0,a.i,[e.p,e.q,e.j,e.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Y(4,1097728,null,0,o.a,[[8,"bar-button"],s.a,e.j,e.z],null,null),(l()(),e.Z(5,0,null,0,2,"ion-icon",[["class","back-button-icon"],["role","img"]],[[2,"hide",null]],null,null,null,null)),e.Y(6,278528,null,0,a.i,[e.p,e.q,e.j,e.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.Y(7,147456,null,0,r.a,[s.a,e.j,e.z],{name:[0,"name"]},null),(l()(),e.Z(8,0,null,0,2,"span",[["class","back-button-text"]],null,null,null,null,null)),e.Y(9,278528,null,0,a.i,[e.p,e.q,e.j,e.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(l()(),e._20(10,null,["",""])),e._10(null,0),e._10(null,1),e._10(null,2),(l()(),e.Z(14,0,null,null,2,"div",[["class","toolbar-content"]],null,null,null,null,null)),e.Y(15,278528,null,0,a.i,[e.p,e.q,e.j,e.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e._10(null,3)],function(l,n){var u=n.component;l(n,1,0,"toolbar-background","toolbar-background-"+u._mode);l(n,3,0,"back-button","back-button-"+u._mode);l(n,6,0,"back-button-icon","back-button-icon-"+u._mode);l(n,7,0,u._bbIcon);l(n,9,0,"back-button-text","back-button-text-"+u._mode);l(n,15,0,"toolbar-content","toolbar-content-"+u._mode)},function(l,n){var u=n.component;l(n,2,0,u._hideBb);l(n,5,0,e._11(n,7)._hidden);l(n,10,0,u._backText)})}u.d(n,"a",function(){return c}),n.b=t;var e=u(0),a=u(11),i=u(46),o=u(19),s=u(1),r=u(38),c=(u(5),u(20),e.X({encapsulation:2,styles:[],data:{}}))},413:function(l,n,u){"use strict";u.d(n,"b",function(){return t}),u.d(n,"a",function(){return e});var t;!function(l){l[l.Video=1]="Video",l[l.Voip=2]="Voip",l[l.Email=3]="Email",l[l.SMS=4]="SMS",l[l.VideoVoiceMail=5]="VideoVoiceMail",l[l.PictureMail=6]="PictureMail"}(t||(t={}));var e;!function(l){l[l.Voip=2]="Voip",l[l.IncomingVoip=3]="IncomingVoip",l[l.PrivilegedVoip=10]="PrivilegedVoip",l[l.MobileVideoVisitation=7]="MobileVideoVisitation",l[l.PrivilegedMobileVideoVisitation=8]="PrivilegedMobileVideoVisitation"}(e||(e={}))}});